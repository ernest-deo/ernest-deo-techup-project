<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoopHub - NBA Schedule</title>
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/nba_schedule-styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="header-container"></div>

    <div id="table-container">
        <table id="sheet-data"></table>
    </div>

    <script>
        // Load the header
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
            });

        function loadExcelFile() {
            fetch('nba_schedule.xlsx')
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(new Uint8Array(data), {type: 'array'});
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];

                    const html = XLSX.utils.sheet_to_html(worksheet, {
                        editable: false,
                        style: true
                    });

                    const parser = new DOMParser();
                    const doc = parser.parseFromString(html, 'text/html');

                    const table = doc.querySelector('table');
                    table.id = 'sheet-data';

                                        // Apply styles and classes
Array.from(table.querySelectorAll('td, th')).forEach((cell) => {
    const style = cell.style;
    cell.className = 'cell';

    if (style.fontWeight === 'bold') cell.classList.add('cell-bold');
    if (style.fontStyle === 'italic') cell.classList.add('cell-italic');
    if (style.textDecoration === 'underline') cell.classList.add('cell-underline');

    // Explicitly set background color and store it as a data attribute
    if (style.backgroundColor) {
        cell.style.backgroundColor = style.backgroundColor;
        cell.dataset.backgroundColor = style.backgroundColor;
    }

    // Explicitly set text color
    if (style.color) {
        cell.style.color = style.color;
    }

    // Preserve all other styles
    ['textAlign', 'fontSize', 'width', 'height', 'verticalAlign', 'borderTop', 'borderBottom', 'borderLeft', 'borderRight'].forEach(prop => {
        if (style[prop]) cell.style[prop] = style[prop];
    });

    // Preserve any custom styles
    cell.setAttribute('style', cell.getAttribute('style'));
});

// Add sticky classes
const rows = table.rows;
for (let i = 0; i < rows.length; i++) {
    const cells = rows[i].cells;
    for (let j = 0; j < cells.length; j++) {
        const cell = cells[j];
        if (i < 3) {
            cell.classList.add('sticky-row');
            cell.classList.add(`sticky-row-${i + 1}`);
        }
        if (j === 0) {
            cell.classList.add('sticky-col');
        }
        if (i < 3 && j === 0) {
            cell.classList.add('sticky-corner');
        }
        
        // Ensure sticky elements maintain their background color
        if (i < 3 || j === 0) {
            const bgColor = cell.dataset.backgroundColor || 'transparent';
            cell.style.backgroundColor = bgColor;
        }
    }
}

                    document.getElementById('sheet-data').innerHTML = '';
                    document.getElementById('sheet-data').appendChild(table);
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('sheet-data').innerHTML = '<p>Error loading sheet data. Please try again later.</p>';
                });
        }

        // Call loadExcelFile when the page loads
        window.onload = loadExcelFile;
    </script>
</body>
<footer>
    <p>&copy; 2024 HoopHub. All rights reserved.</p>
    <p class="disclaimer-text">Disclaimer: This website is created for learning purposes only. The information here should not be considered professional advice. Please note that we make no guarantees regarding the accuracy, completeness, or reliability of the contents of this website. Any actions you take based on the contents of this website are at your own risk. We are not liable for any losses or damages incurred from the use of this website.</p>
</footer>
</html>