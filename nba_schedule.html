<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HoopHub - NBA Schedule</title>
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/nba_schedule-styles.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
    <div id="header-container"></div>

    <div id="table-container">
        <table id="sheet-data"></table>
    </div>

        <div id="table-container">
        <table id="sheet-data"></table>
    </div>

    <script>
        // Load the header
        fetch('header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header-container').innerHTML = data;
            });

        // Load the Excel file
        document.addEventListener('DOMContentLoaded', loadExcelFile);

        function loadExcelFile() {
            fetch('nba_schedule.xlsx')
                .then(response => response.arrayBuffer())
                .then(data => {
                    const workbook = XLSX.read(new Uint8Array(data), {type: 'array', cellStyles: true});
                    const firstSheetName = workbook.SheetNames[0];
                    const worksheet = workbook.Sheets[firstSheetName];

                    // Convert the worksheet to HTML
                    const html = XLSX.utils.sheet_to_html(worksheet, {id: 'sheet-data'});

                    // Replace the existing table content with the new one
                    document.getElementById('table-container').innerHTML = html;

                    // Apply additional classes and styles
                    const table = document.getElementById('sheet-data');
                    Array.from(table.querySelectorAll('td, th')).forEach((cell, index) => {
                        cell.classList.add('cell');

                        // Add sticky classes
                        const rowIndex = cell.parentElement.rowIndex;
                        const colIndex = cell.cellIndex;

                        if (rowIndex < 3) {
                            cell.classList.add('sticky-row', `sticky-row-${rowIndex + 1}`);
                        }
                        if (colIndex === 0) {
                            cell.classList.add('sticky-col');
                        }
                        if (rowIndex < 3 && colIndex === 0) {
                            cell.classList.add('sticky-corner');
                        }

                        // Apply fill color from Excel
                        const cellAddress = XLSX.utils.encode_cell({r: rowIndex, c: colIndex});
                        const cellInfo = worksheet[cellAddress];
                        if (cellInfo && cellInfo.s && cellInfo.s.fill && cellInfo.s.fill.fgColor) {
                            const fillColor = cellInfo.s.fill.fgColor.rgb;
                            console.log(`Cell ${cellAddress}: Fill color = ${fillColor}`);
                            if (fillColor) {
                                cell.style.setProperty('background-color', '#' + fillColor, 'important');
                            }
                        }
                    });

                    // Apply sticky styling
                    applyStickyStyling();
                })
                .catch(error => {
                    console.error('Error:', error);
                    document.getElementById('table-container').innerHTML = '<p>Error loading sheet data. Please try again later.</p>';
                });
        }

        function applyStickyStyling() {
            const stickyElements = document.querySelectorAll('.sticky-row, .sticky-col, .sticky-corner');
            stickyElements.forEach(element => {
                // Ensure the background color is preserved for sticky elements
                if (element.style.backgroundColor) {
                    element.style.backgroundColor = element.style.backgroundColor;
                }
            });
        }
    </script>
</body>
<footer>
    <p>&copy; 2024 HoopHub. All rights reserved.</p>
    <p class="disclaimer-text">Disclaimer: This website is created for learning purposes only. The information here should not be considered professional advice. Please note that we make no guarantees regarding the accuracy, completeness, or reliability of the contents of this website. Any actions you take based on the contents of this website are at your own risk. We are not liable for any losses or damages incurred from the use of this website.</p>
</footer>
</html>